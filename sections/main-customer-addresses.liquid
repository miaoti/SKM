<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-16" data-customer-addresses>
  
  <!-- Header: Logistics Command Center Style -->
  <div class="flex flex-col md:flex-row md:items-center justify-between mb-12 border-b-2 border-black pb-6">
    <div>
      <h1 class="text-3xl font-bold uppercase tracking-tighter text-[#111111] mb-2">
        Shipping Destinations
      </h1>
      <p class="text-gray-500 uppercase tracking-widest text-xs">
        Logistics Command Center // Manage Delivery Points
      </p>
    </div>
    <div class="mt-6 md:mt-0">
      <button 
        type="button"
        aria-expanded="false"
        aria-controls="AddAddress"
        onclick="document.getElementById('AddAddress').classList.remove('hidden')"
        class="h-12 px-8 bg-[#CC0000] text-white font-bold uppercase tracking-wider hover:bg-black transition-colors shadow-lg flex items-center gap-2"
      >
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="w-5 h-5">
          <path stroke-linecap="round" stroke-linejoin="round" d="M12 4.5v15m7.5-7.5h-15" />
        </svg>
        Add New Address
      </button>
    </div>
  </div>

  {% paginate customer.addresses by 6 %}
    
    <!-- Address Grid -->
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
      
      {% for address in customer.addresses %}
        <div class="relative bg-white border border-gray-200 p-8 shadow-sm hover:shadow-md transition-shadow group">
          
          <!-- Default Badge -->
          {% if address == customer.default_address %}
            <span class="absolute top-0 right-0 bg-[#CC0000] text-white text-[10px] font-bold uppercase tracking-wider px-3 py-1">
              Default
            </span>
          {% endif %}

          <!-- Address Content (Monospaced for label look) -->
          <div class="font-mono text-sm text-gray-800 leading-relaxed mb-8">
            {{ address | format_address }}
          </div>

          <!-- Actions -->
          <div class="flex items-center gap-6 border-t border-gray-100 pt-6">
            <button
              type="button"
              id="EditFormButton_{{ address.id }}"
              aria-label="Edit address {{ forloop.index }}"
              aria-controls="EditAddress_{{ address.id }}"
              aria-expanded="false"
              data-address-id="{{ address.id }}"
              onclick="document.getElementById('EditAddress_{{ address.id }}').classList.remove('hidden')"
              class="text-xs font-bold uppercase tracking-wider text-[#111111] hover:text-[#CC0000] transition-colors flex items-center gap-1"
            >
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-4 h-4">
                <path stroke-linecap="round" stroke-linejoin="round" d="M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L10.582 16.07a4.5 4.5 0 01-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 011.13-1.897l8.932-8.931zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0115.75 21H5.25A2.25 2.25 0 013 18.75V8.25A2.25 2.25 0 015.25 6H10" />
              </svg>
              Edit
            </button>
            
            <form
              method="post"
              action="/account/addresses/{{ address.id }}"
            >
              <input type="hidden" name="_method" value="delete">
              <button
                type="submit"
                class="text-xs font-bold uppercase tracking-wider text-[#CC0000] hover:text-black transition-colors flex items-center gap-1"
                onclick="return confirm('Are you sure you want to delete this address?');"
              >
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-4 h-4">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M14.74 9l-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 01-2.244 2.077H8.084a2.25 2.25 0 01-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 00-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 013.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 00-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 00-7.5 0" />
                </svg>
                Delete
              </button>
            </form>
          </div>
        </div>

        <!-- Edit Address Modal -->
        <div id="EditAddress_{{ address.id }}" class="hidden fixed inset-0 z-[1000] overflow-y-auto" role="dialog" aria-modal="true">
          <!-- Backdrop -->
          <div class="fixed inset-0 bg-black/50 backdrop-blur-sm transition-opacity" onclick="document.getElementById('EditAddress_{{ address.id }}').classList.add('hidden')"></div>
          
          <!-- Modal Panel -->
          <div class="flex min-h-full items-center justify-center p-4 text-center">
            <div class="relative transform overflow-hidden bg-white text-left shadow-xl transition-all w-full max-w-2xl border-t-4 border-[#CC0000]">
              
              <div class="bg-white px-4 pb-4 pt-5 sm:p-6 sm:pb-4">
                <h2 class="text-xl font-bold uppercase tracking-wide text-[#111111] mb-6 border-b border-gray-100 pb-4">Edit Logistics Point</h2>
                
                {% form 'customer_address', address %}
                  <div class="space-y-4">
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                      <!-- First Name -->
                      <div class="relative group">
                        <input type="text" id="AddressFirstName_{{ form.id }}" name="address[first_name]" value="{{ form.first_name }}" autocomplete="given-name" placeholder="First Name" class="peer w-full h-12 bg-gray-50 border-b-2 border-gray-200 text-[#111111] placeholder-transparent focus:outline-none focus:border-[#CC0000] focus:bg-white transition-all px-4">
                        <label for="AddressFirstName_{{ form.id }}" class="absolute left-4 -top-3.5 text-xs text-gray-500 transition-all peer-placeholder-shown:text-base peer-placeholder-shown:text-gray-400 peer-placeholder-shown:top-3 peer-focus:-top-3.5 peer-focus:text-[#CC0000] peer-focus:text-xs font-bold uppercase tracking-wide">First Name</label>
                      </div>
                      
                      <!-- Last Name -->
                      <div class="relative group">
                        <input type="text" id="AddressLastName_{{ form.id }}" name="address[last_name]" value="{{ form.last_name }}" autocomplete="family-name" placeholder="Last Name" class="peer w-full h-12 bg-gray-50 border-b-2 border-gray-200 text-[#111111] placeholder-transparent focus:outline-none focus:border-[#CC0000] focus:bg-white transition-all px-4">
                        <label for="AddressLastName_{{ form.id }}" class="absolute left-4 -top-3.5 text-xs text-gray-500 transition-all peer-placeholder-shown:text-base peer-placeholder-shown:text-gray-400 peer-placeholder-shown:top-3 peer-focus:-top-3.5 peer-focus:text-[#CC0000] peer-focus:text-xs font-bold uppercase tracking-wide">Last Name</label>
                      </div>
                    </div>

                    <!-- Company -->
                    <div class="relative group">
                      <input type="text" id="AddressCompany_{{ form.id }}" name="address[company]" value="{{ form.company }}" autocomplete="organization" placeholder="Company" class="peer w-full h-12 bg-gray-50 border-b-2 border-gray-200 text-[#111111] placeholder-transparent focus:outline-none focus:border-[#CC0000] focus:bg-white transition-all px-4">
                      <label for="AddressCompany_{{ form.id }}" class="absolute left-4 -top-3.5 text-xs text-gray-500 transition-all peer-placeholder-shown:text-base peer-placeholder-shown:text-gray-400 peer-placeholder-shown:top-3 peer-focus:-top-3.5 peer-focus:text-[#CC0000] peer-focus:text-xs font-bold uppercase tracking-wide">Company</label>
                    </div>

                    <!-- Address 1 -->
                    <div class="relative group">
                      <input type="text" id="AddressAddress1_{{ form.id }}" name="address[address1]" value="{{ form.address1 }}" autocomplete="address-line1" placeholder="Address 1" class="peer w-full h-12 bg-gray-50 border-b-2 border-gray-200 text-[#111111] placeholder-transparent focus:outline-none focus:border-[#CC0000] focus:bg-white transition-all px-4">
                      <label for="AddressAddress1_{{ form.id }}" class="absolute left-4 -top-3.5 text-xs text-gray-500 transition-all peer-placeholder-shown:text-base peer-placeholder-shown:text-gray-400 peer-placeholder-shown:top-3 peer-focus:-top-3.5 peer-focus:text-[#CC0000] peer-focus:text-xs font-bold uppercase tracking-wide">Address 1</label>
                    </div>

                    <!-- Address 2 -->
                    <div class="relative group">
                      <input type="text" id="AddressAddress2_{{ form.id }}" name="address[address2]" value="{{ form.address2 }}" autocomplete="address-line2" placeholder="Address 2" class="peer w-full h-12 bg-gray-50 border-b-2 border-gray-200 text-[#111111] placeholder-transparent focus:outline-none focus:border-[#CC0000] focus:bg-white transition-all px-4">
                      <label for="AddressAddress2_{{ form.id }}" class="absolute left-4 -top-3.5 text-xs text-gray-500 transition-all peer-placeholder-shown:text-base peer-placeholder-shown:text-gray-400 peer-placeholder-shown:top-3 peer-focus:-top-3.5 peer-focus:text-[#CC0000] peer-focus:text-xs font-bold uppercase tracking-wide">Address 2</label>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                      <!-- City -->
                      <div class="relative group">
                        <input type="text" id="AddressCity_{{ form.id }}" name="address[city]" value="{{ form.city }}" autocomplete="address-level2" placeholder="City" class="peer w-full h-12 bg-gray-50 border-b-2 border-gray-200 text-[#111111] placeholder-transparent focus:outline-none focus:border-[#CC0000] focus:bg-white transition-all px-4">
                        <label for="AddressCity_{{ form.id }}" class="absolute left-4 -top-3.5 text-xs text-gray-500 transition-all peer-placeholder-shown:text-base peer-placeholder-shown:text-gray-400 peer-placeholder-shown:top-3 peer-focus:-top-3.5 peer-focus:text-[#CC0000] peer-focus:text-xs font-bold uppercase tracking-wide">City</label>
                      </div>

                      <!-- Country -->
                      <div class="relative group">
                         <select id="AddressCountry_{{ form.id }}" name="address[country]" data-address-country-select data-default="{{ form.country }}" data-form-id="{{ form.id }}" autocomplete="country" class="peer w-full h-12 bg-gray-50 border-b-2 border-gray-200 text-[#111111] focus:outline-none focus:border-[#CC0000] focus:bg-white transition-all px-4 appearance-none">
                            {{ all_country_option_tags }}
                         </select>
                         <label for="AddressCountry_{{ form.id }}" class="absolute left-4 -top-3.5 text-xs text-gray-500 font-bold uppercase tracking-wide">Country</label>
                         <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="absolute right-4 top-3.5 w-4 h-4 text-gray-400 pointer-events-none">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M19.5 8.25l-7.5 7.5-7.5-7.5" />
                         </svg>
                      </div>
                    </div>

                    <!-- Province (Hidden by default, shown via JS) -->
                    <div id="AddressProvinceContainer_{{ form.id }}" style="display:none;" class="relative group">
                      <select id="AddressProvince_{{ form.id }}" name="address[province]" data-default="{{ form.province }}" autocomplete="address-level1" class="peer w-full h-12 bg-gray-50 border-b-2 border-gray-200 text-[#111111] focus:outline-none focus:border-[#CC0000] focus:bg-white transition-all px-4 appearance-none">
                      </select>
                      <label for="AddressProvince_{{ form.id }}" class="absolute left-4 -top-3.5 text-xs text-gray-500 font-bold uppercase tracking-wide">Province / State</label>
                       <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="absolute right-4 top-3.5 w-4 h-4 text-gray-400 pointer-events-none">
                          <path stroke-linecap="round" stroke-linejoin="round" d="M19.5 8.25l-7.5 7.5-7.5-7.5" />
                       </svg>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                      <!-- Zip -->
                      <div class="relative group">
                        <input type="text" id="AddressZip_{{ form.id }}" name="address[zip]" value="{{ form.zip }}" autocapitalize="characters" autocomplete="postal-code" placeholder="Zip" class="peer w-full h-12 bg-gray-50 border-b-2 border-gray-200 text-[#111111] placeholder-transparent focus:outline-none focus:border-[#CC0000] focus:bg-white transition-all px-4">
                        <label for="AddressZip_{{ form.id }}" class="absolute left-4 -top-3.5 text-xs text-gray-500 transition-all peer-placeholder-shown:text-base peer-placeholder-shown:text-gray-400 peer-placeholder-shown:top-3 peer-focus:-top-3.5 peer-focus:text-[#CC0000] peer-focus:text-xs font-bold uppercase tracking-wide">Zip / Postal Code</label>
                      </div>

                      <!-- Phone -->
                      <div class="relative group">
                        <input type="tel" id="AddressPhone_{{ form.id }}" name="address[phone]" value="{{ form.phone }}" autocomplete="tel" placeholder="Phone" class="peer w-full h-12 bg-gray-50 border-b-2 border-gray-200 text-[#111111] placeholder-transparent focus:outline-none focus:border-[#CC0000] focus:bg-white transition-all px-4">
                        <label for="AddressPhone_{{ form.id }}" class="absolute left-4 -top-3.5 text-xs text-gray-500 transition-all peer-placeholder-shown:text-base peer-placeholder-shown:text-gray-400 peer-placeholder-shown:top-3 peer-focus:-top-3.5 peer-focus:text-[#CC0000] peer-focus:text-xs font-bold uppercase tracking-wide">Phone</label>
                      </div>
                    </div>

                    <!-- Default Checkbox -->
                    <div class="flex items-center gap-2 mt-4">
                      {{ form.set_as_default_checkbox }}
                      <label for="address_default_address_{{ form.id }}" class="text-sm text-gray-600 font-medium">Set as default address</label>
                    </div>

                    <!-- Buttons -->
                    <div class="flex gap-4 pt-6">
                      <button type="submit" class="flex-1 h-12 bg-[#111111] text-white font-bold uppercase tracking-widest hover:bg-[#CC0000] transition-colors">Update Address</button>
                      <button type="button" onclick="document.getElementById('EditAddress_{{ address.id }}').classList.add('hidden')" class="h-12 px-6 border border-gray-300 text-gray-500 font-bold uppercase tracking-widest hover:border-[#111111] hover:text-[#111111] transition-colors">Cancel</button>
                    </div>

                  </div>
                {% endform %}
              </div>

            </div>
          </div>
        </div>

      {% endfor %}
    </div>

    <!-- Pagination -->
    {% if paginate.pages > 1 %}
      <div class="mt-12 flex justify-center">
         {% render 'pagination', paginate: paginate %}
      </div>
    {% endif %}

  {% endpaginate %}

  <!-- Add New Address Modal -->
  <div id="AddAddress" class="hidden fixed inset-0 z-[1000] overflow-y-auto" role="dialog" aria-modal="true">
    <!-- Backdrop -->
    <div class="fixed inset-0 bg-black/50 backdrop-blur-sm transition-opacity" onclick="document.getElementById('AddAddress').classList.add('hidden')"></div>
    
    <!-- Modal Panel -->
    <div class="flex min-h-full items-center justify-center p-4 text-center">
      <div class="relative transform overflow-hidden bg-white text-left shadow-xl transition-all w-full max-w-2xl border-t-4 border-[#CC0000]">
        
        <div class="bg-white px-4 pb-4 pt-5 sm:p-6 sm:pb-4">
          <h2 class="text-xl font-bold uppercase tracking-wide text-[#111111] mb-6 border-b border-gray-100 pb-4">Add New Destination</h2>
          
          {% form 'customer_address', customer.new_address %}
            <div class="space-y-4">
              
              <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <!-- First Name -->
                <div class="relative group">
                  <input type="text" id="AddressFirstNameNew" name="address[first_name]" value="{{ form.first_name }}" autocomplete="given-name" placeholder="First Name" class="peer w-full h-12 bg-gray-50 border-b-2 border-gray-200 text-[#111111] placeholder-transparent focus:outline-none focus:border-[#CC0000] focus:bg-white transition-all px-4">
                  <label for="AddressFirstNameNew" class="absolute left-4 -top-3.5 text-xs text-gray-500 transition-all peer-placeholder-shown:text-base peer-placeholder-shown:text-gray-400 peer-placeholder-shown:top-3 peer-focus:-top-3.5 peer-focus:text-[#CC0000] peer-focus:text-xs font-bold uppercase tracking-wide">First Name</label>
                </div>
                
                <!-- Last Name -->
                <div class="relative group">
                  <input type="text" id="AddressLastNameNew" name="address[last_name]" value="{{ form.last_name }}" autocomplete="family-name" placeholder="Last Name" class="peer w-full h-12 bg-gray-50 border-b-2 border-gray-200 text-[#111111] placeholder-transparent focus:outline-none focus:border-[#CC0000] focus:bg-white transition-all px-4">
                  <label for="AddressLastNameNew" class="absolute left-4 -top-3.5 text-xs text-gray-500 transition-all peer-placeholder-shown:text-base peer-placeholder-shown:text-gray-400 peer-placeholder-shown:top-3 peer-focus:-top-3.5 peer-focus:text-[#CC0000] peer-focus:text-xs font-bold uppercase tracking-wide">Last Name</label>
                </div>
              </div>

              <!-- Company -->
              <div class="relative group">
                <input type="text" id="AddressCompanyNew" name="address[company]" value="{{ form.company }}" autocomplete="organization" placeholder="Company" class="peer w-full h-12 bg-gray-50 border-b-2 border-gray-200 text-[#111111] placeholder-transparent focus:outline-none focus:border-[#CC0000] focus:bg-white transition-all px-4">
                <label for="AddressCompanyNew" class="absolute left-4 -top-3.5 text-xs text-gray-500 transition-all peer-placeholder-shown:text-base peer-placeholder-shown:text-gray-400 peer-placeholder-shown:top-3 peer-focus:-top-3.5 peer-focus:text-[#CC0000] peer-focus:text-xs font-bold uppercase tracking-wide">Company</label>
              </div>

              <!-- Address 1 -->
              <div class="relative group">
                <input type="text" id="AddressAddress1New" name="address[address1]" value="{{ form.address1 }}" autocomplete="address-line1" placeholder="Address 1" class="peer w-full h-12 bg-gray-50 border-b-2 border-gray-200 text-[#111111] placeholder-transparent focus:outline-none focus:border-[#CC0000] focus:bg-white transition-all px-4">
                <label for="AddressAddress1New" class="absolute left-4 -top-3.5 text-xs text-gray-500 transition-all peer-placeholder-shown:text-base peer-placeholder-shown:text-gray-400 peer-placeholder-shown:top-3 peer-focus:-top-3.5 peer-focus:text-[#CC0000] peer-focus:text-xs font-bold uppercase tracking-wide">Address 1</label>
              </div>

              <!-- Address 2 -->
              <div class="relative group">
                <input type="text" id="AddressAddress2New" name="address[address2]" value="{{ form.address2 }}" autocomplete="address-line2" placeholder="Address 2" class="peer w-full h-12 bg-gray-50 border-b-2 border-gray-200 text-[#111111] placeholder-transparent focus:outline-none focus:border-[#CC0000] focus:bg-white transition-all px-4">
                <label for="AddressAddress2New" class="absolute left-4 -top-3.5 text-xs text-gray-500 transition-all peer-placeholder-shown:text-base peer-placeholder-shown:text-gray-400 peer-placeholder-shown:top-3 peer-focus:-top-3.5 peer-focus:text-[#CC0000] peer-focus:text-xs font-bold uppercase tracking-wide">Address 2</label>
              </div>

              <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <!-- City -->
                <div class="relative group">
                  <input type="text" id="AddressCityNew" name="address[city]" value="{{ form.city }}" autocomplete="address-level2" placeholder="City" class="peer w-full h-12 bg-gray-50 border-b-2 border-gray-200 text-[#111111] placeholder-transparent focus:outline-none focus:border-[#CC0000] focus:bg-white transition-all px-4">
                  <label for="AddressCityNew" class="absolute left-4 -top-3.5 text-xs text-gray-500 transition-all peer-placeholder-shown:text-base peer-placeholder-shown:text-gray-400 peer-placeholder-shown:top-3 peer-focus:-top-3.5 peer-focus:text-[#CC0000] peer-focus:text-xs font-bold uppercase tracking-wide">City</label>
                </div>

                <!-- Country -->
                <div class="relative group">
                   <select id="AddressCountryNew" name="address[country]" data-address-country-select data-default="{{ form.country }}" data-form-id="New" autocomplete="country" class="peer w-full h-12 bg-gray-50 border-b-2 border-gray-200 text-[#111111] focus:outline-none focus:border-[#CC0000] focus:bg-white transition-all px-4 appearance-none">
                      {{ all_country_option_tags }}
                   </select>
                   <label for="AddressCountryNew" class="absolute left-4 -top-3.5 text-xs text-gray-500 font-bold uppercase tracking-wide">Country</label>
                   <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="absolute right-4 top-3.5 w-4 h-4 text-gray-400 pointer-events-none">
                      <path stroke-linecap="round" stroke-linejoin="round" d="M19.5 8.25l-7.5 7.5-7.5-7.5" />
                   </svg>
                </div>
              </div>

              <!-- Province (Hidden by default, shown via JS) -->
              <div id="AddressProvinceContainerNew" style="display:none;" class="relative group">
                <select id="AddressProvinceNew" name="address[province]" data-default="{{ form.province }}" autocomplete="address-level1" class="peer w-full h-12 bg-gray-50 border-b-2 border-gray-200 text-[#111111] focus:outline-none focus:border-[#CC0000] focus:bg-white transition-all px-4 appearance-none">
                </select>
                <label for="AddressProvinceNew" class="absolute left-4 -top-3.5 text-xs text-gray-500 font-bold uppercase tracking-wide">Province / State</label>
                 <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="absolute right-4 top-3.5 w-4 h-4 text-gray-400 pointer-events-none">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M19.5 8.25l-7.5 7.5-7.5-7.5" />
                 </svg>
              </div>

              <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <!-- Zip -->
                <div class="relative group">
                  <input type="text" id="AddressZipNew" name="address[zip]" value="{{ form.zip }}" autocapitalize="characters" autocomplete="postal-code" placeholder="Zip" class="peer w-full h-12 bg-gray-50 border-b-2 border-gray-200 text-[#111111] placeholder-transparent focus:outline-none focus:border-[#CC0000] focus:bg-white transition-all px-4">
                  <label for="AddressZipNew" class="absolute left-4 -top-3.5 text-xs text-gray-500 transition-all peer-placeholder-shown:text-base peer-placeholder-shown:text-gray-400 peer-placeholder-shown:top-3 peer-focus:-top-3.5 peer-focus:text-[#CC0000] peer-focus:text-xs font-bold uppercase tracking-wide">Zip / Postal Code</label>
                </div>

                <!-- Phone -->
                <div class="relative group">
                  <input type="tel" id="AddressPhoneNew" name="address[phone]" value="{{ form.phone }}" autocomplete="tel" placeholder="Phone" class="peer w-full h-12 bg-gray-50 border-b-2 border-gray-200 text-[#111111] placeholder-transparent focus:outline-none focus:border-[#CC0000] focus:bg-white transition-all px-4">
                  <label for="AddressPhoneNew" class="absolute left-4 -top-3.5 text-xs text-gray-500 transition-all peer-placeholder-shown:text-base peer-placeholder-shown:text-gray-400 peer-placeholder-shown:top-3 peer-focus:-top-3.5 peer-focus:text-[#CC0000] peer-focus:text-xs font-bold uppercase tracking-wide">Phone</label>
                </div>
              </div>

              <!-- Default Checkbox -->
              <div class="flex items-center gap-2 mt-4">
                {{ form.set_as_default_checkbox }}
                <label for="address_default_address_new" class="text-sm text-gray-600 font-medium">Set as default address</label>
              </div>

              <!-- Buttons -->
              <div class="flex gap-4 pt-6">
                <button type="submit" class="flex-1 h-12 bg-[#111111] text-white font-bold uppercase tracking-widest hover:bg-[#CC0000] transition-colors">Add Address</button>
                <button type="button" onclick="document.getElementById('AddAddress').classList.add('hidden')" class="h-12 px-6 border border-gray-300 text-gray-500 font-bold uppercase tracking-widest hover:border-[#111111] hover:text-[#111111] transition-colors">Cancel</button>
              </div>

            </div>
          {% endform %}
        </div>

      </div>
    </div>
  </div>

</div>

<script>
  window.addEventListener('load', () => {
    // Country/Province Selector Logic
    // We use a simple custom implementation here instead of Shopify's heavy legacy JS
    
    const countrySelectors = document.querySelectorAll('[data-address-country-select]');
    
    countrySelectors.forEach(select => {
      const formId = select.dataset.formId;
      const provinceContainer = document.getElementById(formId === 'New' ? 'AddressProvinceContainerNew' : `AddressProvinceContainer_${formId}`);
      const provinceSelect = document.getElementById(formId === 'New' ? 'AddressProvinceNew' : `AddressProvince_${formId}`);
      
      if (!provinceSelect) return;

      // Initialize provinces based on selected country
      const updateProvinces = () => {
        const selectedOption = select.options[select.selectedIndex];
        const provinces = JSON.parse(selectedOption.dataset.provinces);
        
        // Clear current options
        provinceSelect.innerHTML = '';
        
        if (provinces && provinces.length > 0) {
          provinceContainer.style.display = 'block';
          
          provinces.forEach(province => {
            const option = document.createElement('option');
            option.value = province[0];
            option.textContent = province[1];
            provinceSelect.appendChild(option);
          });
          
          // Set default if exists
          const defaultProvince = provinceSelect.dataset.default;
          if (defaultProvince && provinceSelect.querySelector(`option[value="${defaultProvince}"]`)) {
             provinceSelect.value = defaultProvince;
          }
        } else {
          provinceContainer.style.display = 'none';
        }
      };

      select.addEventListener('change', updateProvinces);
      
      // Initial trigger
      updateProvinces();
    });
  });
</script>