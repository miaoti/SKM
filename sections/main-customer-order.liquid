<!-- The Verification Protocol - Order Detail (Light Mode) -->
<style>
  /* Typography Imports */
  @import url('https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;600;700&display=swap');
  
  .order-protocol {
    --racing-red: #CC0000;
    --obsidian: #111111;
    --steel-grey: #f8f8f8;
    --card-bg: #ffffff;
    --border-color: #e5e5e5;
    --data-grey: #666666;
    --signal-green: #22c55e;
    font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;
  }
  
  .mono-data {
    font-family: 'JetBrains Mono', monospace;
  }
  
  .tabular-nums {
    font-variant-numeric: tabular-nums;
    font-family: 'JetBrains Mono', monospace;
  }
  
  /* Signal Pills - Light Mode */
  .signal-pill {
    display: inline-flex;
    align-items: center;
    gap: 6px;
    padding: 4px 12px;
    border: 1px solid var(--border-color);
    background: var(--card-bg);
    color: var(--obsidian);
    font-size: 10px;
    letter-spacing: 0.1em;
    text-transform: uppercase;
  }
  
  .signal-pill .glow-dot {
    width: 6px;
    height: 6px;
    border-radius: 50%;
    background: var(--signal-green);
    box-shadow: 0 0 4px var(--signal-green);
  }
  
  .signal-pill.fulfillment-active {
    border-color: var(--racing-red);
    background: var(--racing-red);
    color: white;
  }
  
  /* Desaturated Image Filter */
  .assembly-image {
    filter: saturate(0.4) contrast(1.05);
    transition: filter 0.3s ease;
  }
  .assembly-image:hover {
    filter: saturate(0.8) contrast(1.1);
  }
  
  /* Ledger Table - Light Mode */
  .ledger-row {
    display: flex;
    justify-content: space-between;
    padding: 8px 0;
    border-bottom: 1px solid var(--border-color);
  }
  .ledger-row:last-child {
    border-bottom: none;
  }
  
  /* Refund Highlight */
  .refund-highlight {
    border-left: 2px solid var(--racing-red);
    padding-left: 12px;
    margin-left: -14px;
  }
  
  /* Support Button - Light Mode */
  .support-init-btn {
    display: block;
    width: 100%;
    padding: 12px;
    border: 1px solid var(--border-color);
    background: transparent;
    color: var(--obsidian);
    font-size: 10px;
    letter-spacing: 0.15em;
    text-align: center;
    text-transform: uppercase;
    transition: all 0.2s ease;
    text-decoration: none;
  }
  .support-init-btn:hover {
    background: var(--racing-red);
    border-color: var(--racing-red);
    color: white;
  }
  
  /* SKM Watermark - Light Mode */
  .skm-watermark {
    position: absolute;
    bottom: 20px;
    right: 20px;
    font-size: 48px;
    font-weight: 900;
    letter-spacing: 0.2em;
    color: rgba(0,0,0,0.03);
    pointer-events: none;
  }
</style>

<div class="order-protocol bg-white min-h-screen text-[#111111]">
  <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-12">
    
    <!-- Breadcrumb Navigation: System Path Style -->
    <nav class="mb-6">
      <a href="/account" class="mono-data text-xs text-[#666666] hover:text-[#CC0000] transition-colors tracking-widest">
        DIRECTORY // ACCOUNT // ORDER_LOG
      </a>
    </nav>
    
    <!-- Global Header: The Verification Protocol -->
    <header class="mb-12 pb-8 border-b border-gray-200">
      <div class="flex flex-col lg:flex-row lg:items-end justify-between gap-6">
        <div>
          <h1 class="text-3xl sm:text-4xl font-black uppercase tracking-tight text-[#111111]" style="font-stretch: expanded;">
            ORDER RECORD: {{ order.name }}
          </h1>
          <p class="mono-data text-xs text-[#666666] mt-2 tracking-widest">
            TIMESTAMP: {{ order.created_at | date: "%Y-%m-%d // %H:%M:%S UTC" }}
          </p>
        </div>
        
        <!-- Signal Pills -->
        <div class="flex flex-wrap gap-3">
          <!-- Payment Signal -->
          {% assign payment_status = order.financial_status | downcase %}
          <div class="signal-pill mono-data">
            {% if payment_status == 'paid' %}
              <span class="glow-dot"></span>
            {% endif %}
            <span>{{ order.financial_status_label | upcase }}</span>
          </div>
          
          <!-- Fulfillment Signal -->
          {% assign fulfillment_status = order.fulfillment_status | downcase %}
          <div class="signal-pill mono-data {% if fulfillment_status == 'fulfilled' %}fulfillment-active{% endif %}">
            <span>{{ order.fulfillment_status_label | default: 'PROCESSING' | upcase }}</span>
          </div>
        </div>
      </div>
    </header>
    
    <!-- Main Grid: Logistics View + Tactical Sidebar -->
    <div style="display: flex; flex-wrap: wrap; gap: 3rem;">
      
      <!-- Left: Main Logistics View (Line Items) -->
      <div style="flex: 2; min-width: 320px;">
        
        <div class="mb-4">
          <h2 class="mono-data text-xs text-[#CC0000] tracking-widest mb-1">MANIFEST_CONTENTS</h2>
          <p class="text-xs text-[#666666]">Major Assembly Components</p>
        </div>
        
        <div class="space-y-4">
          {% for line_item in order.line_items %}
            <div class="bg-[#f8f8f8] border border-gray-200 p-4 sm:p-6 relative overflow-hidden group">
              
              <div class="flex gap-4 sm:gap-6">
                <!-- Assembly Image (Desaturated) -->
                <div class="relative flex-shrink-0" style="width: 100px; height: 100px;">
                  {% if line_item.image %}
                    <img 
                      src="{{ line_item.image | image_url: width: 200 }}" 
                      alt="{{ line_item.title }}"
                      class="assembly-image w-full h-full object-cover border border-white/10"
                      loading="lazy"
                    >
                  {% else %}
                    <div class="w-full h-full bg-gray-100 border border-gray-200 flex items-center justify-center">
                      <span class="mono-data text-xs text-gray-400">NO_IMG</span>
                    </div>
                  {% endif %}
                  
                  <!-- SKU Reference Tag -->
                  {% if line_item.sku != blank %}
                    <div class="absolute bottom-0 left-0 right-0 bg-[#111111] px-2 py-1">
                      <span class="mono-data text-[8px] text-gray-400 tracking-wider">ID_REF: {{ line_item.sku }}</span>
                    </div>
                  {% endif %}
                </div>
                
                <!-- Component Specs -->
                <div class="flex-grow min-w-0">
                  <div class="flex flex-col sm:flex-row sm:items-start justify-between gap-2">
                    <div>
                      <!-- Product Title -->
                      {% if line_item.product.url %}
                        <a href="{{ line_item.product.url }}" class="font-bold text-[#111111] hover:text-[#CC0000] transition-colors block text-sm sm:text-base">
                          {{ line_item.title | upcase }}
                        </a>
                      {% else %}
                        <p class="font-bold text-[#111111] text-sm sm:text-base">{{ line_item.title | upcase }}</p>
                      {% endif %}
                      
                      <!-- Variant Spec -->
                      {% if line_item.variant.title != 'Default Title' %}
                        <p class="mono-data text-xs text-[#666666] mt-1 tracking-wider">
                          SPEC: {{ line_item.variant.title | upcase | replace: ' ', '_' }}
                        </p>
                      {% endif %}
                    </div>
                    
                    <!-- Price -->
                    <div class="text-left sm:text-right flex-shrink-0">
                      <p class="tabular-nums font-bold text-[#111111]">{{ line_item.final_line_price | money }}</p>
                      {% if line_item.original_line_price != line_item.final_line_price %}
                        <p class="tabular-nums text-xs text-gray-400 line-through">{{ line_item.original_line_price | money }}</p>
                      {% endif %}
                    </div>
                  </div>
                  
                  <!-- Quantity -->
                  <p class="mono-data text-xs text-[#666666] mt-2 tracking-wider">
                    QTY: {{ line_item.quantity }} @ {{ line_item.final_price | money }}/UNIT
                  </p>
                  
                  <!-- Integrated Tracking Intelligence -->
                  {% if line_item.fulfillment %}
                    <div class="mt-3 pt-3 border-t border-gray-200">
                      <div class="flex items-center gap-2">
                        <span class="mono-data text-xs text-[#666666]">TRACKING_ID:</span>
                        {% if line_item.fulfillment.tracking_url %}
                          <a href="{{ line_item.fulfillment.tracking_url }}" target="_blank" rel="noopener" 
                             class="mono-data text-xs text-[#CC0000] hover:underline group/track"
                             title="LINK_TO_{{ line_item.fulfillment.tracking_company | upcase | default: 'CARRIER' }}">
                            {{ line_item.fulfillment.tracking_number | default: 'PENDING' }}
                            <span class="text-[#666666] opacity-0 group-hover/track:opacity-100 transition-opacity ml-1">
                              [{{ line_item.fulfillment.tracking_company | upcase | default: 'CARRIER' }}]
                            </span>
                          </a>
                        {% elsif line_item.fulfillment.tracking_number %}
                          <span class="mono-data text-xs text-white">{{ line_item.fulfillment.tracking_number }}</span>
                        {% else %}
                          <span class="mono-data text-xs text-[#444444]">LOGISTICS_PROCESSING...</span>
                        {% endif %}
                      </div>
                    </div>
                  {% else %}
                    <div class="mt-3 pt-3 border-t border-gray-200">
                      <span class="mono-data text-xs text-[#444444]">STATUS: LOGISTICS_PROCESSING...</span>
                    </div>
                  {% endif %}
                </div>
              </div>
              
            </div>
          {% endfor %}
        </div>
        
      </div>
      
      <!-- Right: Tactical Intelligence Sidebar -->
      <div style="flex: 1; min-width: 280px; max-width: 360px;">
        
        <!-- Financial Ledger -->
        <div class="bg-[#f8f8f8] border border-gray-200 p-5 mb-6 relative">
          <h3 class="mono-data text-xs text-[#CC0000] tracking-widest mb-4">FINANCIAL_LEDGER</h3>
          
          <div class="space-y-0">
            <div class="ledger-row">
              <span class="text-xs text-[#666666] uppercase tracking-wider">Subtotal</span>
              <span class="tabular-nums text-sm text-[#111111]">{{ order.line_items_subtotal_price | money }}</span>
            </div>
            
            {% for discount in order.cart_level_discount_applications %}
              <div class="ledger-row">
                <span class="text-xs text-green-500 uppercase tracking-wider">Discount ({{ discount.title }})</span>
                <span class="tabular-nums text-sm text-green-500">-{{ discount.total_allocated_amount | money }}</span>
              </div>
            {% endfor %}
            
            <div class="ledger-row">
              <span class="text-xs text-[#666666] uppercase tracking-wider">Shipping</span>
              {% if order.shipping_price > 0 %}
                <span class="tabular-nums text-sm text-[#111111]">{{ order.shipping_price | money }}</span>
              {% else %}
                <span class="tabular-nums text-sm text-green-600">WAIVED</span>
              {% endif %}
            </div>
            
            {% if order.tax_price > 0 %}
              <div class="ledger-row">
                <span class="text-xs text-[#666666] uppercase tracking-wider">Tax</span>
                <span class="tabular-nums text-sm text-[#111111]">{{ order.tax_price | money }}</span>
              </div>
            {% endif %}
            
            <div class="ledger-row pt-3 mt-2 border-t border-gray-300">
              <span class="text-xs text-[#111111] uppercase tracking-wider font-bold">Total</span>
              <span class="tabular-nums text-lg text-[#111111] font-bold">{{ order.total_price | money }}</span>
            </div>
          </div>
          
          <!-- Refund Adjustment -->
          {% if order.financial_status == 'refunded' or order.financial_status == 'partially_refunded' %}
            <div class="mt-4 pt-4 border-t border-gray-300">
              <div class="refund-highlight">
                <p class="mono-data text-xs text-[#CC0000] tracking-widest mb-2">REFUND_ADJUSTMENT</p>
                {% for transaction in order.transactions %}
                  {% if transaction.kind == 'refund' %}
                    <div class="ledger-row">
                      <span class="text-xs text-[#666666]">CREDIT_ISSUED</span>
                      <span class="tabular-nums text-sm text-[#CC0000]">-{{ transaction.amount | money }}</span>
                    </div>
                  {% endif %}
                {% endfor %}
              </div>
            </div>
          {% endif %}
          
          <!-- SKM Watermark -->
          <div class="skm-watermark">SKM</div>
        </div>
        
        <!-- Shipping Manifest -->
        <div class="bg-[#f8f8f8] border border-gray-200 p-5 mb-6">
          <h3 class="mono-data text-[8px] text-[#CC0000] tracking-widest mb-3">SHIP_TO:</h3>
          {% if order.shipping_address %}
            <div class="mono-data text-xs text-[#444444] uppercase tracking-wider leading-relaxed">
              <p class="font-bold text-[#111111]">{{ order.shipping_address.name }}</p>
              {% if order.shipping_address.company %}<p>{{ order.shipping_address.company }}</p>{% endif %}
              <p>{{ order.shipping_address.address1 }}</p>
              {% if order.shipping_address.address2 %}<p>{{ order.shipping_address.address2 }}</p>{% endif %}
              <p>{{ order.shipping_address.city }}, {{ order.shipping_address.province_code }} {{ order.shipping_address.zip }}</p>
              <p>{{ order.shipping_address.country }}</p>
            </div>
          {% else %}
            <p class="mono-data text-xs text-gray-400">NO_PHYSICAL_DELIVERY</p>
          {% endif %}
        </div>
        
        <!-- Billing Manifest -->
        <div class="bg-[#f8f8f8] border border-gray-200 p-5 mb-6">
          <h3 class="mono-data text-[8px] text-[#CC0000] tracking-widest mb-3">BILL_TO:</h3>
          {% if order.billing_address %}
            <div class="mono-data text-xs text-[#444444] uppercase tracking-wider leading-relaxed">
              <p class="font-bold text-[#111111]">{{ order.billing_address.name }}</p>
              {% if order.billing_address.company %}<p>{{ order.billing_address.company }}</p>{% endif %}
              <p>{{ order.billing_address.address1 }}</p>
              {% if order.billing_address.address2 %}<p>{{ order.billing_address.address2 }}</p>{% endif %}
              <p>{{ order.billing_address.city }}, {{ order.billing_address.province_code }} {{ order.billing_address.zip }}</p>
              <p>{{ order.billing_address.country }}</p>
            </div>
          {% else %}
            <p class="mono-data text-xs text-gray-400">SAME_AS_SHIPPING</p>
          {% endif %}
        </div>
        
        <!-- Payment Gateway -->
        <div class="bg-[#f8f8f8] border border-gray-200 p-5 mb-6">
          <h3 class="mono-data text-[8px] text-[#CC0000] tracking-widest mb-3">PAYMENT_GATEWAY:</h3>
          {% for transaction in order.transactions %}
            {% if transaction.kind == 'sale' or transaction.kind == 'capture' or transaction.kind == 'authorization' %}
              <div class="flex items-center gap-3">
                <div class="w-8 h-5 bg-gray-200 border border-gray-300 flex items-center justify-center">
                  <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-3 h-3 text-[#666666]">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M2.25 8.25h19.5M2.25 9h19.5m-16.5 5.25h6m-6 2.25h3m-3.75 3h15a2.25 2.25 0 002.25-2.25V6.75A2.25 2.25 0 0019.5 4.5h-15a2.25 2.25 0 00-2.25 2.25v10.5A2.25 2.25 0 004.5 19.5z" />
                  </svg>
                </div>
                <div>
                  <p class="mono-data text-xs text-[#111111] uppercase tracking-wider">
                    {{ transaction.gateway | replace: '_', ' ' | replace: 'shopify payments', 'SECURE_CARD' | upcase }}
                  </p>
                  <p class="tabular-nums text-xs text-[#666666]">{{ transaction.amount | money }}</p>
                </div>
              </div>
              {% break %}
            {% endif %}
          {% endfor %}
        </div>
        
        <!-- Support Initialization -->
        <a href="/pages/contact" class="support-init-btn mono-data">
          [ INITIALIZE_SUPPORT_INQUIRY ]
        </a>
        
      </div>
      
    </div>
    
  </div>
</div>

{% schema %}
{
  "name": "Order Protocol",
  "tag": "section"
}
{% endschema %}
